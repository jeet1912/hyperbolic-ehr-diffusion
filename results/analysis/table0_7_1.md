Using device: mps

hyperbolic_ddpm_depth7 | max_depth = 7 | Real stats: {'mean_depth': 5.374459093875327, 'std_depth': 1.7322915840970905, 'mean_tree_dist': 5.76189079147913, 'std_tree_dist': 4.753635709372622, 'mean_root_purity': 0.6272780762911319, 'std_root_purity': 0.2050864797754083}

Training hyperbolic DDPM | lambda_recon=500
Epoch   1 | Train 97.557543 | Val 34.453503 | lambda_recon=500 | lambda_pair=0.01
Epoch   2 | Train 30.563920 | Val 25.997929 | lambda_recon=500 | lambda_pair=0.01
Epoch   3 | Train 26.305883 | Val 22.971406 | lambda_recon=500 | lambda_pair=0.01
Epoch   4 | Train 24.048435 | Val 21.523698 | lambda_recon=500 | lambda_pair=0.01
Epoch   5 | Train 22.984067 | Val 20.498504 | lambda_recon=500 | lambda_pair=0.01
Epoch   6 | Train 21.950762 | Val 20.117552 | lambda_recon=500 | lambda_pair=0.01
Epoch   7 | Train 21.531864 | Val 19.866097 | lambda_recon=500 | lambda_pair=0.01
Epoch   8 | Train 20.843664 | Val 19.024115 | lambda_recon=500 | lambda_pair=0.01
Epoch   9 | Train 20.174478 | Val 18.227795 | lambda_recon=500 | lambda_pair=0.01
Epoch  10 | Train 19.343157 | Val 17.842103 | lambda_recon=500 | lambda_pair=0.01
Epoch  11 | Train 19.069674 | Val 17.712096 | lambda_recon=500 | lambda_pair=0.01
Epoch  12 | Train 18.839719 | Val 17.619236 | lambda_recon=500 | lambda_pair=0.01
Epoch  13 | Train 18.315740 | Val 16.726358 | lambda_recon=500 | lambda_pair=0.01
Epoch  14 | Train 17.818719 | Val 16.595808 | lambda_recon=500 | lambda_pair=0.01
Epoch  15 | Train 17.649633 | Val 16.610942 | lambda_recon=500 | lambda_pair=0.01
Epoch  16 | Train 17.560386 | Val 16.588306 | lambda_recon=500 | lambda_pair=0.01
Epoch  17 | Train 17.451591 | Val 16.545613 | lambda_recon=500 | lambda_pair=0.01
Epoch  18 | Train 17.398724 | Val 16.524720 | lambda_recon=500 | lambda_pair=0.01
Epoch  19 | Train 17.348162 | Val 16.512965 | lambda_recon=500 | lambda_pair=0.01
Epoch  20 | Train 17.276535 | Val 16.471351 | lambda_recon=500 | lambda_pair=0.01
Epoch  21 | Train 17.208459 | Val 16.521862 | lambda_recon=500 | lambda_pair=0.01
Epoch  22 | Train 17.160286 | Val 16.515749 | lambda_recon=500 | lambda_pair=0.01
Epoch  23 | Train 17.123188 | Val 16.520894 | lambda_recon=500 | lambda_pair=0.01
Epoch  24 | Train 17.063306 | Val 16.444642 | lambda_recon=500 | lambda_pair=0.01
Epoch  25 | Train 16.960790 | Val 15.980995 | lambda_recon=500 | lambda_pair=0.01
Epoch  26 | Train 16.428791 | Val 15.798514 | lambda_recon=500 | lambda_pair=0.01
Epoch  27 | Train 16.268360 | Val 15.666840 | lambda_recon=500 | lambda_pair=0.01
Epoch  28 | Train 16.202412 | Val 15.692155 | lambda_recon=500 | lambda_pair=0.01
Epoch  29 | Train 16.155677 | Val 15.620040 | lambda_recon=500 | lambda_pair=0.01
Epoch  30 | Train 16.118603 | Val 15.638631 | lambda_recon=500 | lambda_pair=0.01
Epoch  31 | Train 16.053028 | Val 15.636053 | lambda_recon=500 | lambda_pair=0.01
Epoch  32 | Train 16.047897 | Val 15.621720 | lambda_recon=500 | lambda_pair=0.01
Epoch  33 | Train 15.987230 | Val 15.635725 | lambda_recon=500 | lambda_pair=0.01
Epoch  34 | Train 15.936149 | Val 15.581834 | lambda_recon=500 | lambda_pair=0.01
Epoch  35 | Train 15.904376 | Val 15.519096 | lambda_recon=500 | lambda_pair=0.01
Epoch  36 | Train 15.874176 | Val 15.540523 | lambda_recon=500 | lambda_pair=0.01
Epoch  37 | Train 15.865997 | Val 15.556458 | lambda_recon=500 | lambda_pair=0.01
Epoch  38 | Train 15.847354 | Val 15.569513 | lambda_recon=500 | lambda_pair=0.01
Epoch  39 | Train 15.828001 | Val 15.561683 | lambda_recon=500 | lambda_pair=0.01
Epoch  40 | Train 15.800570 | Val 15.551645 | lambda_recon=500 | lambda_pair=0.01
Epoch  41 | Train 15.791753 | Val 15.510556 | lambda_recon=500 | lambda_pair=0.01
Epoch  42 | Train 15.795891 | Val 15.516504 | lambda_recon=500 | lambda_pair=0.01
Epoch  43 | Train 15.761975 | Val 15.520716 | lambda_recon=500 | lambda_pair=0.01
Epoch  44 | Train 15.766080 | Val 15.543693 | lambda_recon=500 | lambda_pair=0.01
Epoch  45 | Train 15.760716 | Val 15.530975 | lambda_recon=500 | lambda_pair=0.01
Epoch  46 | Train 15.749053 | Val 15.521648 | lambda_recon=500 | lambda_pair=0.01
Epoch  47 | Train 15.750366 | Val 15.511832 | lambda_recon=500 | lambda_pair=0.01
Epoch  48 | Train 15.747772 | Val 15.522687 | lambda_recon=500 | lambda_pair=0.01
Epoch  49 | Train 15.735498 | Val 15.544676 | lambda_recon=500 | lambda_pair=0.01
Epoch  50 | Train 15.731382 | Val 15.533704 | lambda_recon=500 | lambda_pair=0.01
Best validation loss: 15.510556
Test Recall@4: 0.0099

Sample hyperbolic trajectory 1:
  Visit 1: ['C032d2', 'C230d2', 'C321d2', 'C330d2']
  Visit 2: ['C032d2', 'C230d2', 'C321d2', 'C330d2']
  Visit 3: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
  Visit 4: ['C032d2', 'C230d2', 'C321d2', 'C330d2']
  Visit 5: ['C032d2', 'C230d2', 'C321d2', 'C330d2']
  Visit 6: ['C032d2', 'C230d2', 'C321d2', 'C330d2']

Sample hyperbolic trajectory 2:
  Visit 1: ['C023d2', 'C032d2', 'C230d2', 'C330d2']
  Visit 2: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
  Visit 3: ['C023d2', 'C032d2', 'C230d2', 'C330d2']
  Visit 4: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
  Visit 5: ['C023d2', 'C032d2', 'C230d2', 'C330d2']
  Visit 6: ['C102d4', 'C301d3', 'C404d3', 'C413d4']

Sample hyperbolic trajectory 3:
  Visit 1: ['C023d2', 'C032d2', 'C230d2', 'C330d2']
  Visit 2: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
  Visit 3: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
  Visit 4: ['C023d2', 'C032d2', 'C230d2', 'C330d2']
  Visit 5: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
  Visit 6: ['C102d4', 'C301d3', 'C404d3', 'C413d4']
Tree/embedding correlation: 0.3903
Synthetic stats (N=1000): {'mean_depth': 5.74475, 'std_depth': 0.8286117531751526, 'mean_tree_dist': 11.4895, 'std_tree_dist': 1.4999632495498012, 'mean_root_purity': 0.5, 'std_root_purity': 0.0}

Training hyperbolic DDPM | lambda_recon=1000
Epoch   1 | Train 77.218435 | Val 44.536961 | lambda_recon=1000 | lambda_pair=0.01
Epoch   2 | Train 43.190884 | Val 38.996759 | lambda_recon=1000 | lambda_pair=0.01
Epoch   3 | Train 39.492430 | Val 36.357251 | lambda_recon=1000 | lambda_pair=0.01
Epoch   4 | Train 37.526086 | Val 34.944880 | lambda_recon=1000 | lambda_pair=0.01
Epoch   5 | Train 36.176362 | Val 34.156219 | lambda_recon=1000 | lambda_pair=0.01
Epoch   6 | Train 35.273268 | Val 33.074064 | lambda_recon=1000 | lambda_pair=0.01
Epoch   7 | Train 34.488216 | Val 32.798240 | lambda_recon=1000 | lambda_pair=0.01
Epoch   8 | Train 33.930097 | Val 32.022586 | lambda_recon=1000 | lambda_pair=0.01
Epoch   9 | Train 32.966268 | Val 30.946732 | lambda_recon=1000 | lambda_pair=0.01
Epoch  10 | Train 32.122240 | Val 30.716712 | lambda_recon=1000 | lambda_pair=0.01
Epoch  11 | Train 31.881093 | Val 30.596543 | lambda_recon=1000 | lambda_pair=0.01
Epoch  12 | Train 31.719690 | Val 30.524381 | lambda_recon=1000 | lambda_pair=0.01
Epoch  13 | Train 31.574192 | Val 30.428553 | lambda_recon=1000 | lambda_pair=0.01
Epoch  14 | Train 31.457447 | Val 30.400783 | lambda_recon=1000 | lambda_pair=0.01
Epoch  15 | Train 31.336409 | Val 30.339717 | lambda_recon=1000 | lambda_pair=0.01
Epoch  16 | Train 31.197377 | Val 30.295681 | lambda_recon=1000 | lambda_pair=0.01
Epoch  17 | Train 31.103211 | Val 30.218369 | lambda_recon=1000 | lambda_pair=0.01
Epoch  18 | Train 30.975687 | Val 30.133483 | lambda_recon=1000 | lambda_pair=0.01
Epoch  19 | Train 30.847979 | Val 29.939262 | lambda_recon=1000 | lambda_pair=0.01
Epoch  20 | Train 30.397261 | Val 29.473941 | lambda_recon=1000 | lambda_pair=0.01
Epoch  21 | Train 30.147953 | Val 29.434766 | lambda_recon=1000 | lambda_pair=0.01
Epoch  22 | Train 30.067731 | Val 29.394667 | lambda_recon=1000 | lambda_pair=0.01
Epoch  23 | Train 29.994177 | Val 29.397206 | lambda_recon=1000 | lambda_pair=0.01
Epoch  24 | Train 29.955442 | Val 29.314483 | lambda_recon=1000 | lambda_pair=0.01
Epoch  25 | Train 29.868294 | Val 29.378472 | lambda_recon=1000 | lambda_pair=0.01
Epoch  26 | Train 29.825546 | Val 29.317667 | lambda_recon=1000 | lambda_pair=0.01
Epoch  27 | Train 29.789348 | Val 29.320812 | lambda_recon=1000 | lambda_pair=0.01
Epoch  28 | Train 29.747510 | Val 29.312615 | lambda_recon=1000 | lambda_pair=0.01
Epoch  29 | Train 29.694572 | Val 29.252228 | lambda_recon=1000 | lambda_pair=0.01
Epoch  30 | Train 29.668460 | Val 29.249617 | lambda_recon=1000 | lambda_pair=0.01
Epoch  31 | Train 29.641507 | Val 29.265031 | lambda_recon=1000 | lambda_pair=0.01
Epoch  32 | Train 29.620160 | Val 29.225259 | lambda_recon=1000 | lambda_pair=0.01
Epoch  33 | Train 29.594037 | Val 29.219820 | lambda_recon=1000 | lambda_pair=0.01
Epoch  34 | Train 29.574808 | Val 29.236177 | lambda_recon=1000 | lambda_pair=0.01
Epoch  35 | Train 29.572697 | Val 29.249701 | lambda_recon=1000 | lambda_pair=0.01
Epoch  36 | Train 29.563856 | Val 29.211856 | lambda_recon=1000 | lambda_pair=0.01
Epoch  37 | Train 29.541222 | Val 29.195463 | lambda_recon=1000 | lambda_pair=0.01
Epoch  38 | Train 29.501992 | Val 29.168502 | lambda_recon=1000 | lambda_pair=0.01
Epoch  39 | Train 29.481503 | Val 29.160735 | lambda_recon=1000 | lambda_pair=0.01
Epoch  40 | Train 29.471961 | Val 29.155186 | lambda_recon=1000 | lambda_pair=0.01
Epoch  41 | Train 29.425878 | Val 29.157214 | lambda_recon=1000 | lambda_pair=0.01
Epoch  42 | Train 29.396785 | Val 29.116863 | lambda_recon=1000 | lambda_pair=0.01
Epoch  43 | Train 29.365030 | Val 29.112644 | lambda_recon=1000 | lambda_pair=0.01
Epoch  44 | Train 29.262991 | Val 28.974101 | lambda_recon=1000 | lambda_pair=0.01
Epoch  45 | Train 29.146532 | Val 28.838702 | lambda_recon=1000 | lambda_pair=0.01
Epoch  46 | Train 28.999592 | Val 28.677349 | lambda_recon=1000 | lambda_pair=0.01
Epoch  47 | Train 28.827141 | Val 28.534983 | lambda_recon=1000 | lambda_pair=0.01
Epoch  48 | Train 28.692694 | Val 28.490585 | lambda_recon=1000 | lambda_pair=0.01
Epoch  49 | Train 28.585183 | Val 28.392442 | lambda_recon=1000 | lambda_pair=0.01
Epoch  50 | Train 28.516568 | Val 28.236598 | lambda_recon=1000 | lambda_pair=0.01
Best validation loss: 28.236598
Test Recall@4: 0.0158

Sample hyperbolic trajectory 1:
  Visit 1: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 2: ['C020d3', 'C020d4', 'C424d3', 'C424d4']
  Visit 3: ['C020d3', 'C020d4', 'C424d3', 'C424d4']
  Visit 4: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 5: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 6: ['C104d3', 'C104d4', 'C242d4', 'C414d4']

Sample hyperbolic trajectory 2:
  Visit 1: ['C020d3', 'C020d4', 'C424d3', 'C424d4']
  Visit 2: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 3: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 4: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 5: ['C020d3', 'C020d4', 'C424d3', 'C424d4']
  Visit 6: ['C104d3', 'C104d4', 'C242d4', 'C414d4']

Sample hyperbolic trajectory 3:
  Visit 1: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 2: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 3: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 4: ['C104d3', 'C104d4', 'C242d4', 'C414d4']
  Visit 5: ['C020d3', 'C020d4', 'C424d3', 'C424d4']
  Visit 6: ['C020d3', 'C020d4', 'C424d3', 'C424d4']
Tree/embedding correlation: 0.4967
Synthetic stats (N=1000): {'mean_depth': 6.6265, 'std_depth': 0.48373313924104894, 'mean_tree_dist': 1.0, 'std_tree_dist': 0.0, 'mean_root_purity': 0.5, 'std_root_purity': 0.0}


